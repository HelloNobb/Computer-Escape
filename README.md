# 컴퓨터를 탈출하라 (Computer Escape)

> **모바일 방탈출 게임** | 팀 프로젝트 (5명, 1개월) | Corona SDK (Lua)
> 
> *미스터리한 저택을 탐험하며 퍼즐과 미니게임을 해결하고 스토리를 밝혀내는 몰입형 모바일 방탈출 게임*

[![Platform](https://img.shields.io/badge/Platform-iOS%20%7C%20Android-blue)]()
[![Engine](https://img.shields.io/badge/Engine-Corona%20SDK-orange)]()
[![Language](https://img.shields.io/badge/Language-Lua-blue)]()

---

## 📋 목차

- [프로젝트 개요](#-프로젝트-개요)
- [담당 구현 내용](#-담당-구현-내용)
  - [1. 게임 내 맵 네비게이션 시스템](#1-게임-내-맵-네비게이션-시스템)
  - [2. 장미 키우기 미니게임](#2-장미-키우기-미니게임)
- [기술 스택](#-기술-스택)
- [게임 기능](#-게임-기능)
- [기술적 하이라이트](#-기술적-하이라이트)
- [설치 및 실행](#-설치-및-실행)

---

## 🎮 프로젝트 개요

**컴퓨터를 탈출하라**는 플레이어가 컴퓨터 안에 갇힌 상황에서 시작하여 다양한 방을 탐험하며 각 방의 미니게임과 퍼즐을 해결해 나가는 스토리 중심의 모바일 방탈출 게임입니다. 플레이어의 선택과 미니게임 성공 여부에 따라 다양한 엔딩이 제공됩니다.

### 프로젝트 정보
- **팀 규모**: 5명
- **개발 기간**: 2개월 (2023년)
- **타겟 플랫폼**: 모바일 (iOS/Android)
- **장르**: 퍼즐/어드벤처/방탈출

---

## 👩‍💻 담당 구현 내용

팀원으로서 저는 다음과 같이 두 가지 주요 컴포넌트를 담당했습니다:

### 1. 게임 내 맵 네비게이션 시스템

**파일**: [`game_lobby.lua`](game_lobby.lua) | [`game_ending_lobby.lua`](game_ending_lobby.lua)

#### 📌 개요
1층 저택 로비의 2D 탑다운 네비게이션 시스템을 구현했습니다. 이 시스템은 모든 미니게임 방을 연결하는 중앙 허브 역할을 하며, 플레이어 이동, 카메라 제어, 충돌 감지, 씬 전환을 처리합니다.

#### 🔧 기술적 구현 내용

##### **캐릭터 이동 & 애니메이션 시스템**
- **4방향 스프라이트 애니메이션**: 각 방향(상, 하, 좌, 우)마다 4프레임 걷기 사이클 구현
- **동적 스프라이트 전환**: 이동 방향에 따라 실시간으로 애니메이션 변경
- **프레임 기반 타이밍**: 부드러운 애니메이션을 위한 타이밍 제어

##### **카메라 패닝 시스템**
- **동적 뷰포트**: 플레이어 중앙 고정, 배경/오브젝트 이동으로 넓은 맵 표현
- **경계 감지**: 맵 끝 처리 및 스크롤 제한
- **조건부 스크롤**: 임계값 기반 카메라 이동 제어

##### **충돌 감지 & 씬 전환**
- **다중 영역 충돌 시스템**: 맵 구역별 차별화된 이동 경계
- **계단 네비게이션**: 위치 감지 기반 층간 전환
- **벽 충돌 처리**: 좌표 기반 이동 제약

##### **상호작용 오브젝트 시스템**
- **위치 기반 상호작용 영역**: 플레이어-오브젝트 간 거리 계산으로 UI 인디케이터 표시
- **다양한 상호작용 타입**:
  - NPC 대화 시스템 (상태 추적)
  - 액자 조사 포인트 (4곳)
  - 열쇠 퍼즐 트리거 (4개)

##### **UI 시스템 통합**
- **터치 기반 방향 컨트롤**: 시각적 피드백 가상 십자키
- **커서 상태 관리**: 상호작용 가능 여부에 따른 동적 커서 변경
- **인벤토리 시스템 통합**: 아이템 관리 오버레이

#### 💡 주요 기술적 성과

1. **모듈화된 아키텍처** - 플레이어 이동, 카메라, 상호작용 로직 분리 설계
2. **성능 최적화** - `Runtime:addEventListener`로 60 FPS 유지, 알파 기반 스프라이트 관리
3. **씬 간 상태 관리** - `composer.setVariable()`로 데이터 지속성, 메모리 누수 방지
4. **복잡한 좌표 시스템** - 다중 영역 충돌 감지, 상대/절대 위치 계산

---

### 2. 장미 키우기 미니게임

**파일**: [`rose_game.lua`](rose_game.lua) | [`rose_intro.lua`](rose_intro.lua) | [`rose_ending.lua`](rose_ending.lua)

#### 📌 개요
*"어린 왕자"*에서 영감을 받은 실시간 리소스 관리 미니게임을 완전히 개발했습니다. 플레이어는 제한 시간 내에 장미에 물을 주고 벌레로부터 보호해야 하며, 게임 루프 설계, 타이머 관리, 상태 기반 프로그래밍 역량을 보여줍니다.

#### 🔧 기술적 구현 내용

##### **게임 루프 & 타이머 시스템**
4개의 독립적인 타이머로 실시간 이벤트 관리:
- **메인 게임 타이머** (1초): 카운트다운, 승패 조건 체크
- **장미 시들기** (4초): 자동 목마름 상태 전환
- **벌레 생성** (7초): 무작위 방향에서 적 생성
- **보너스 이벤트** (9초): 양 확인 → 보너스 시간(+10초)

##### **상태 머신 구현**
불리언 플래그 기반 다중 상태 동시 관리:
- `isThirsty`, `isAttacked`, `isWorried`, `gameStarted` 등
- 시간 기반 카운터로 실패 조건 추적 (5초 방치 시 게임오버)

##### **터치 기반 상호작용 시스템**

**드래그 앤 드롭 물주기**:
- 3단계 터치 이벤트 처리 (began → moved → ended)
- 범위 내 드롭 시 물주기 애니메이션 재생
- 범위 밖 드롭 시 원위치 복귀

**탭으로 벌레 제거**:
- 터치 이벤트로 즉시 제거
- 사운드 피드백 및 상태 업데이트

##### **애니메이션 시스템**
- **물뿌리개**: 기울이기 → 유지 → 복귀 시퀀스 애니메이션 (콜백 체이닝)
- **벌레 이동**: 무작위 방향 생성 → 장미로 이동 → 도착 시 상태 변경

##### **오디오 통합**
- 상황별 사운드 이펙트 (물주기, 시들기, 벌레 공격/제거 등)
- 다중 채널 오디오 관리

#### 💡 주요 기술적 성과

1. **복잡한 이벤트 기반 아키텍처**
   - 4개의 독립적인 타이머 루프가 동시에 실행
   - 씬 종료 시 적절한 타이머 정리로 메모리 누수 방지
   - 성능 저하 없이 매초 상태 검증

2. **완성도 & 사용자 경험**
   - 시각적 피드백이 있는 부드러운 드래그 앤 드롭
   - 순차적 동작을 위한 애니메이션 콜백
   - 액션 실패 시 원위치 복귀 (장미 위가 아닐 때)

3. **게임 밸런스 디자인**
   - 다중 시간 압박 요소 (시들기, 벌레, 양)
   - 좋은 플레이에 대한 보상 메커니즘 (보너스 시간)
   - 난이도 상승 (3개 이상의 메커니즘을 동시에 관리해야 함)

4. **JSON 기반 대화 시스템**
   - 스토리 콘텐츠를 위한 외부 JSON 파일 (`rose_json/*.json`)
   - 코드 변경 없이 콘텐츠 수정 가능
   - 게임 로직과 내러티브 콘텐츠 분리

5. **씬 생명주기 관리**
   ```lua
   function scene:hide(event)
       -- 씬을 떠날 때 모든 타이머 정리
       timer.cancel(roseTimer)
       timer.cancel(bugTimer)
       timer.cancel(checkTimer)
       timer.cancel(gameTimer)
   end
   ```

---

## 🛠️ 기술 스택

### 게임 엔진 & 언어
- **Corona SDK (Solar2D)**: 크로스 플랫폼 모바일 게임 프레임워크
- **Lua**: 주 프로그래밍 언어
- **Composer Library**: 씬 관리 및 전환

### 개발 도구
- **Corona Simulator**: 실시간 테스팅 및 디버깅
- **JSON**: 데이터 기반 콘텐츠 관리

### 타겟 플랫폼
- **iOS**: iPhone/iPad 지원
- **Android**: 다중 해상도 지원 (1080x1920 가로 모드)

### 에셋 관리
- **커스텀 스프라이트 애니메이션**: 손그림 픽셀 아트 캐릭터
- **오디오 시스템**: BGM과 SFX를 위한 다중 사운드 채널
- **리소스 최적화**: 동적 로딩/언로딩

---

## 🎯 게임 기능

### 다양한 미니게임
게임에는 각각 고유한 메커니즘을 가진 여러 미니게임이 포함되어 있습니다:
- **장미 게임** (내가 구현): 실시간 리소스 관리
- **거짓말쟁이 게임**: 논리와 추론 퍼즐
- **그림 게임**: 시각 기억 챌린지
- **열쇠 퍼즐**: 패턴 인식
- **로봇 게임**: 숨겨진 오브젝트 찾기
- **백신 퍼즐**: 다단계 챌린지

### 핵심 게임 시스템
- **스토리 중심 진행**: 다중 엔딩 분기 내러티브
- **인벤토리 시스템**: 아이템 수집 및 사용
- **NPC 상호작용**: 캐릭터 기반 스토리텔링
- **퀘스트 시스템**: 가이드 목표 및 힌트
- **저장 시스템**: 전역 변수를 사용한 진행도 지속성

---

## ⚡ 기술적 하이라이트

### 핵심 스킬 요약

✅ **게임 메커니즘 구현** - 캐릭터 이동, 카메라 시스템, 타이머 기반 게임 루프  
✅ **상태 관리** - 불리언 상태 머신, 씬 간 데이터 지속성, 메모리 관리  
✅ **사용자 입력** - 터치 이벤트, 드래그 앤 드롭, 가상 컨트롤  
✅ **성능 최적화** - 60 FPS 목표, 효율적 리소스 관리  
✅ **팀 협업** - 다른 개발자의 시스템과 원활한 통합  

---

## 🚀 설치 및 실행

### 사전 요구사항
- Corona SDK / Solar2D 설치
- iOS Simulator 또는 Android Emulator

### 프로젝트 실행
```bash
# 저장소 클론
git clone [repository-url]

# Corona Simulator에서 열기
corona-simulator main.lua
```

### 모바일 빌드
```bash
# iOS용
corona-simulator --platform ios

# Android용
corona-simulator --platform android
```

---

## 📁 프로젝트 구조

```
Computer_Escape/
├── main.lua                    # 진입점, 전역 변수, 사운드 초기화
├── config.lua                  # 디스플레이 설정 (1080x1920 가로)
├── build.settings             # 플랫폼별 빌드 설정
│
├── game_lobby.lua             # [내 작업] 메인 네비게이션 시스템
├── game_ending_lobby.lua      # [내 작업] 엔딩 게임 네비게이션 변형
│
├── rose_game.lua              # [내 작업] 장미 미니게임 핵심 로직
├── rose_intro.lua             # [내 작업] 장미 게임 인트로 씬
├── rose_ending.lua            # [내 작업] 장미 게임 엔딩 씬
├── rose_json/                 # [내 작업] 대화 데이터 파일
│   ├── rose_pi.json
│   ├── rose_pi2.json
│   └── rose_pi3.json
│
├── liar_*.lua                 # 거짓말쟁이 미니게임 (팀원 작업)
├── artist_*.lua               # 그림 미니게임 (팀원 작업)
├── compass_*.lua              # 컴퓨터 네비게이션 (팀원 작업)
├── 2nd_floor_*.lua            # 2층 씬 (팀원 작업)
│
├── inventoryScene.lua         # 인벤토리 시스템
├── json/                      # 대화 및 퀘스트 데이터
├── image/                     # 모든 게임 스프라이트 및 배경
├── sound/                     # 오디오 파일 (48개)
└── font/                      # 커스텀 게임 폰트
```


---

## 📊 코드 통계

- **전체 프로젝트 규모**: 약 30,000줄 이상의 Lua 코드
- **내 기여도**: 
  - 맵 네비게이션 시스템: 722줄 (`game_lobby.lua`)
  - 장미 미니게임: 586줄 (`rose_game.lua`)
  - 장미 인트로: 463줄 (`rose_intro.lua`)
  - 추가 지원 씬: 약 500줄
  - **총계**: 약 2,200줄 이상의 프로덕션 코드
  
- **개발 기간**: 2개월 (2023년)
- **팀 협업**: 4명의 다른 개발자와 성공적으로 통합

